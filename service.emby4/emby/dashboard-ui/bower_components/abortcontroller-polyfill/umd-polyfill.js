!function(factory){"function"==typeof define&&define.amd?define(factory):factory()}(function(){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}var Emitter=function(){function Emitter(){_classCallCheck(this,Emitter),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return _createClass(Emitter,[{key:"addEventListener",value:function(type,callback){type in this.listeners||(this.listeners[type]=[]),this.listeners[type].push(callback)}},{key:"removeEventListener",value:function(type,callback){if(type in this.listeners)for(var stack=this.listeners[type],i=0,l=stack.length;i<l;i++)if(stack[i]===callback)return void stack.splice(i,1)}},{key:"dispatchEvent",value:function(event){var _this=this;if(event.type in this.listeners){for(var debounce=function(callback){setTimeout(function(){return callback.call(_this,event)})},stack=this.listeners[event.type],i=0,l=stack.length;i<l;i++)debounce(stack[i]);return!event.defaultPrevented}}}]),Emitter}(),AbortSignal=function(){function AbortSignal(){var _this2;return _classCallCheck(this,AbortSignal),(_this2=function(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?_assertThisInitialized(self):call}(this,_getPrototypeOf(AbortSignal).call(this))).listeners||Emitter.call(_assertThisInitialized(_this2)),Object.defineProperty(_assertThisInitialized(_this2),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(_assertThisInitialized(_this2),"onabort",{value:null,writable:!0,configurable:!0}),_this2}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(AbortSignal,Emitter),_createClass(AbortSignal,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(event){"abort"===event.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,event)),_get(_getPrototypeOf(AbortSignal.prototype),"dispatchEvent",this).call(this,event)}}]),AbortSignal}(),AbortController=function(){function AbortController(){_classCallCheck(this,AbortController),Object.defineProperty(this,"signal",{value:new AbortSignal,writable:!0,configurable:!0})}return _createClass(AbortController,[{key:"abort",value:function(){var event;try{event=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(event=document.createEvent("Event")).initEvent("abort",!1,!1):(event=document.createEventObject()).type="abort":event={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(event)}},{key:"toString",value:function(){return"[object AbortController]"}}]),AbortController}();function polyfillNeeded(self){return self.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof self.Request&&!self.Request.prototype.hasOwnProperty("signal")||!self.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(AbortController.prototype[Symbol.toStringTag]="AbortController",AbortSignal.prototype[Symbol.toStringTag]="AbortSignal"),function(self){if(polyfillNeeded(self))if(self.fetch){var _abortableFetch=function(patchTargets){"function"==typeof patchTargets&&(patchTargets={fetch:patchTargets});var _patchTargets=patchTargets,fetch=_patchTargets.fetch,_patchTargets$Request=_patchTargets.Request,NativeRequest=void 0===_patchTargets$Request?fetch.Request:_patchTargets$Request,NativeAbortController=_patchTargets.AbortController,_patchTargets$__FORCE=_patchTargets.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=void 0!==_patchTargets$__FORCE&&_patchTargets$__FORCE;if(!polyfillNeeded({fetch:fetch,Request:NativeRequest,AbortController:NativeAbortController,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL}))return{fetch:fetch,Request:Request};var Request=NativeRequest;(Request&&!Request.prototype.hasOwnProperty("signal")||__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL)&&((Request=function(input,init){var signal;init&&init.signal&&(signal=init.signal,delete init.signal);var request=new NativeRequest(input,init);return signal&&Object.defineProperty(request,"signal",{writable:!1,enumerable:!1,configurable:!0,value:signal}),request}).prototype=NativeRequest.prototype);var realFetch=fetch;return{fetch:function(input,init){var signal=Request&&Request.prototype.isPrototypeOf(input)?input.signal:init?init.signal:void 0;if(signal){var abortError;try{abortError=new DOMException("Aborted","AbortError")}catch(err){(abortError=new Error("Aborted")).name="AbortError"}if(signal.aborted)return Promise.reject(abortError);var cancellation=new Promise(function(_,reject){signal.addEventListener("abort",function(){return reject(abortError)},{once:!0})});return init&&init.signal&&delete init.signal,Promise.race([cancellation,realFetch(input,init)])}return realFetch(input,init)},Request:Request}}(self),fetch=_abortableFetch.fetch,Request=_abortableFetch.Request;self.fetch=fetch,self.Request=Request,Object.defineProperty(self,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:AbortController}),Object.defineProperty(self,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:AbortSignal})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:global)});